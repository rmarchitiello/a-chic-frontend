/* ===============================================================
   CMS  –  STILI COMPLETI (sidebar + griglia media)
   =============================================================== */

/* ----------------------------------------------------------------
   1. WRAPPER PRINCIPALE (.cms-layout)
   ---------------------------------------------------------------- */
.cms-layout {
  /* due colonne affiancate:  sidebar | contenuto */
  display: flex;

  /* occupa tutta l’altezza disponibile (min 600 px) */
  height: 100%;
  min-height: 600px;

  /* bordo e arrotondamento contenitore */
  border: 1px solid #ddd;
  border-radius: 6px;

  /* nascondo eventuali overflow (angoli arrotondati) */
  overflow: hidden;
}

/* ----------------------------------------------------------------
   2. SIDEBAR  –  struttura ad albero (mat-tree)
   ---------------------------------------------------------------- */
.cms-sidebar {
  /* larghezza minima fissa, si adatta se serve */
  min-width: 280px;
  width: fit-content;
  max-width: 100%;

  /* colori di fondo e bordo divisorio */
  background-color: #f5f5f5;
  border-right: 1px solid #ccc;

  /* padding interno */
  padding: 1rem;

  /* scroll interno sia y che x */
  overflow-y: auto;
  overflow-x: auto;
  position: relative;

  /* scrollbar sottili (Firefox) */
  scrollbar-width: thin;
  scrollbar-color: #ccc transparent;

  /* scrollbar WebKit */
  &::-webkit-scrollbar { width: 8px; height: 8px; }
  &::-webkit-scrollbar-thumb { background: #ccc; border-radius: 4px; }
  &::-webkit-scrollbar-track { background: transparent; }

  /* ---------------- Icone di azione nel nodo cartella ------------- */
  .node-content {
    display: flex;
    align-items: center;
    gap: 4px;         /* spaziatura fra icone */
    width: 100%;

    /* di default icone invisibili */
    .delete-folder-button,
    .create-folder-button,
    .rename-folder-button {
      opacity: 0;
      transition: opacity .2s ease;
    }

    /* compaiono on-hover */
    &:hover .delete-folder-button,
    &:hover .create-folder-button,
    &:hover .rename-folder-button {
      opacity: 1;
    }

    /* dimensione uniforme dei pulsanti */
    button.mat-icon-button {
      width: 28px;
      height: 28px;
      padding: 0;
      margin-left: 4px;

      mat-icon { font-size: 18px; line-height: 1; }
    }

    /* colori icone */
    .delete-folder-button   mat-icon { color: #f44336; }
    .create-folder-button   mat-icon { color: #1976d2; }
    .rename-folder-button   mat-icon { color: #1a344e; }

    .delete-folder-button:hover  mat-icon { color: #d32f2f; }
    .create-folder-button:hover  mat-icon { color: #1565c0; }
    .rename-folder-button:hover  mat-icon { color: #1a344e; }
  }

  /* --------- testo del nodo (ellipsis e tooltip on-hover) ---------- */
  .mat-tree-node span {
    display: inline-block;
    max-width: 220px;
    cursor: pointer;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    vertical-align: middle;
  }

  .mat-tree-node span:hover {
    overflow: visible;
    white-space: normal;
    background: #fff;
    padding: 2px 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,.1);
    z-index: 10;
    position: relative;
  }
}

/* Spinner centrato (durante caricamento cartelle) */
.spinner-container {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
  z-index: 10;
}

/* ----------------------------------------------------------------
   3. COLONNA CONTENUTI  –  griglia di media
   ---------------------------------------------------------------- */
.cms-content {
  flex: 1;                 /* riempie lo spazio restante */
  padding: 2rem;
  background: #fff;
  overflow-y: auto;

  /* Griglia auto-fill: colonne min 220 px */
  .immagini-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 1.5rem;

    /* --------------- CARD MEDIA (immagine / video / audio) -------- */
    .immagine-box {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 1rem;
      background: #fafafa;
      transition: box-shadow .2s ease;
      display: flex;
      flex-direction: column;
      gap: .5rem;
      cursor: pointer;
      position: relative;

      &:hover { box-shadow: 0 2px 8px rgba(0,0,0,.15); }

      /* ---------- wrapper di UN singolo media ---------- */
      .immagine-wrapper {
        position: relative;

        /* media vero e proprio (img / video / audio) */
        .immagine-principale   { width: 100%; border-radius: 8px; }
        .audio-player, .video-player { width: 100%; }

        /* leggera animazione zoom solo sulle immagini */
        .immagine-principale:hover { transform: scale(1.03); transition: transform .2s; }

        /* --------------------- PULSANTE “X” -------------------- */
        .delete-button {
          position: absolute;
          top: -4px;            /* angolo esterno */
          right: -4px;
          width: 36px; height: 36px;
          border-radius: 50%;
          background: #f44336;
          color: #fff;
          display: flex; align-items: center; justify-content: center;
          z-index: 12;
          box-shadow: 0 2px 6px rgba(0,0,0,.2);
          transition: background .2s;
          mat-icon { font-size: 20px; }
          &:hover { background: #d32f2f; }
        }

        /* ------------------ PULSANTE “DOWNLOAD” ------------------ */
        .download-button {
          position: absolute;
          top: 40px;            /* sotto la X: 36px + 4px margine */
          right: -4px;
          width: 36px; height: 36px;
          border-radius: 50%;
          background: #2196f3;
          color: #fff;
          display: flex; align-items: center; justify-content: center;
          z-index: 11;          /* appena sotto la X */
          text-decoration: none;
          transition: background .2s;
          mat-icon { font-size: 20px; }
          &:hover { background: #1e88e5; }
        }
      }

      /* ---------------- SEZIONE DETTAGLI ---------------- */
      .dettagli {
        text-align: center;
        strong { display: block; font-size: 1rem; color: #333; }
        p      { font-size: .9rem; margin: .3rem 0; }
        small  { color: #999; }
      }

      /* --------------- FORM di MODIFICA --------------- */
      form {
        display: flex;
        flex-direction: column;
        gap: 1rem;

        .full-width { width: 100%; }

        .form-actions {
          display: flex;
          justify-content: space-between;
          gap: 1rem;
        }
      }
    } /* /immagine-box */
  } /* /immagini-grid */
}

/* Nasconde tutti i meta NON frontal (immagini) */
.hide { display: none !important; }

/* ----------------------------------------------------------------
   4. UTILITIES (icone, selezione nodo, ecc.)
   ---------------------------------------------------------------- */
mat-icon.mr-2       { margin-right: 8px; }
mat-icon.transparent{ opacity: 0; }

.selected-node {
  background: #e3f2fd;
  border-radius: 4px;
  padding: 2px 4px;
}

/* ----------------------------------------------------------------
   5. BLOCCO AVVISO MOBILE
   ---------------------------------------------------------------- */
.mobile-blocked {
  max-width: 90%;
  margin: 5rem auto;
  padding: 2rem;
  text-align: center;
  background: #fef2f2;
  border: 1px solid #f5c2c7;
  border-radius: 8px;
  color: #b02a37;

  h2 { font-size: 1.4rem; margin-bottom: 1rem; }
  p  { font-size: 1rem;  color: #721c24;     }
}

/* ----------------------------------------------------------------
   6. INDENTAZIONE LIVELLI mat-tree  (::ng-deep per forzare)
   ---------------------------------------------------------------- */
::ng-deep .mat-tree-node              { padding-left: 0 !important; }
::ng-deep .mat-nested-tree-node       { display: block; }
::ng-deep .mat-tree-node.mat-tree-node-level-0 { padding-left:   0px !important; }
::ng-deep .mat-tree-node.mat-tree-node-level-1 { padding-left:  24px !important; }
::ng-deep .mat-tree-node.mat-tree-node-level-2 { padding-left:  48px !important; }
::ng-deep .mat-tree-node.mat-tree-node-level-3 { padding-left:  72px !important; }
::ng-deep .mat-tree-node.mat-tree-node-level-4 { padding-left:  96px !important; }

/* ----------------------------------------------------------------
   7. PULSANTE “Vai a Carica Contenuti” (in fondo alla sidebar)
   ---------------------------------------------------------------- */
.refresh-button { margin-top: 10px; }

.tutorial-box {
  background-color: #fff8e1;
  border-left: 5px solid #ffc107;
  padding: 16px;
  margin-bottom: 24px;
  border-radius: 6px;

  h3 {
    margin-top: 0;
    color: #ff9800;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  ul {
    margin: 0;
    padding-left: 20px;

    li {
      margin-bottom: 8px;
    }
  }

  code {
    background-color: #ffe0b2;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: monospace;
  }
}
