

<!-- Contenuto principale del dialog -->
<div mat-dialog-content class="download-dialog-content">

    <button mat-icon-button class="chiudi-btn" matTooltip="Chiudi" *ngIf="!downloadInCorso" (click)="chiudiPopUp()">
      <mat-icon>close</mat-icon>
    </button>


  <!-- Overlay con spinner visibile durante l'eliminazione -->
  <div class="eliminazione-overlay" *ngIf="downloadInCorso">
    <mat-spinner diameter="48"></mat-spinner>
    <p>Download in corso...</p>
  </div>

  <!-- Contenitore anteprime media -->
  <div class="preview-container" [class.blur]="downloadInCorso">

    <!-- Ciclo su ogni media da mostrare -->
    <ng-container *ngFor="let media of mediaInput">
      <div 
           class="preview-wrapper">

        <!-- Pulsante elimina singolo media -->
        <button class="download-btn"
                mat-icon-button
                color="warn"
                aria-label="Elimina media"
                (click)="downloadMedia(false, media)">
          <mat-icon>download</mat-icon>
        </button>

        <!-- Anteprima dinamica: immagine / video / audio -->
        <ng-container *ngIf="getMediaFrontale(media) as mediaFrontale">
  <ng-container [ngSwitch]="media.type">

    <!-- Immagine -->
    <img *ngSwitchCase="'image'"
         [src]="mediaFrontale.url"
         [alt]="media.display_name"
         class="preview-img" />

    <!-- Video senza controlli, con click disabilitato -->
    <video *ngSwitchCase="'video'"
           [src]="mediaFrontale.url"
           autoplay
           muted
           loop
           playsinline
           class="preview-img"
           style="pointer-events: none;">
    </video>

    <!-- Audio con autoplay e click disabilitato -->
    <audio *ngSwitchCase="'audio'"
           [src]="mediaFrontale.url"
           autoplay
           class="preview-audio"
           style="pointer-events: none;">
    </audio>

    <!-- Fallback per tipi sconosciuti -->
    <div *ngSwitchDefault class="anteprima-non-disponibile">
      <mat-icon>error_outline</mat-icon>
      <span>Tipo non supportato</span>
    </div>

  </ng-container>
</ng-container>

        <!-- Nome del file -->
        <p>{{ media.display_name }}</p>
      </div>
    </ng-container>
  </div>

  
</div>

<!-- Azioni in basso -->
<div mat-dialog-actions align="end"
     class="download-dialog-actions"
     [class.blur]="downloadInCorso">



  <!-- Pulsante elimina tutti -->
  <button mat-flat-button
          color="warn"
          type="button"
          (click)="downloadMedia(true)">
          Scarica tutto
  </button>
</div>



