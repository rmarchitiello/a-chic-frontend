

<!-- Contenuto principale del dialog -->
<div mat-dialog-content class="delete-dialog-content">

    <button mat-icon-button class="chiudi-btn" matTooltip="Chiudi" *ngIf="!eliminazioneInCorso" (click)="annulla()">
      <mat-icon>close</mat-icon>
    </button>


  <!-- Overlay con spinner visibile durante l'eliminazione -->
  <div class="eliminazione-overlay" *ngIf="eliminazioneInCorso">
    <mat-spinner diameter="48"></mat-spinner>
    <p>Eliminazione in corso...</p>
  </div>

  <!-- Contenitore anteprime media -->
  <div class="preview-container" [class.blur]="eliminazioneInCorso">

    <!-- Ciclo su ogni media da mostrare -->
    <ng-container *ngFor="let img of mediaInput">
      <div *ngIf="!img.inEliminazione"
           class="preview-wrapper"
           [ngClass]="{
             'errore': img.erroreEliminazione,
             'in-eliminazione': img.inEliminazione
           }"
           [matTooltip]="img.dettaglioErrore || ''"
           matTooltipPosition="above">

        <!-- Pulsante elimina singolo media -->
        <button class="delete-btn"
                mat-icon-button
                color="warn"
                aria-label="Elimina media"
                (click)="deleteMedia(false, img)">
          <mat-icon>delete</mat-icon>
        </button>

        <!-- Anteprima dinamica: immagine / video / audio -->
        <ng-container [ngSwitch]="img.type">

          <!-- Immagine -->
          <img *ngSwitchCase="'image'"
               [src]="img.url"
               [alt]="img.display_name"
               class="preview-img" />

          <!-- Video senza controlli, con click disabilitato -->
          <video *ngSwitchCase="'video'"
                 [src]="img.url"
                 autoplay
                 muted
                 loop
                 playsinline
                 class="preview-img"
                 style="pointer-events: none;">
          </video>

          <!-- Audio con autoplay e click disabilitato -->
          <audio *ngSwitchCase="'audio'"
                 [src]="img.url"
                 autoplay
                 class="preview-audio"
                 style="pointer-events: none;">
          </audio>

          <!-- Fallback per tipi sconosciuti -->
          <div *ngSwitchDefault class="anteprima-non-disponibile">
            <mat-icon>error_outline</mat-icon>
            <span>Tipo non supportato</span>
          </div>

        </ng-container>

        <!-- Nome del file -->
        <p>{{ img.display_name }}</p>
      </div>
    </ng-container>
  </div>

  <!-- Messaggio di conferma -->
  <p class="confirm-text" [class.blur]="eliminazioneInCorso">
    Sei sicuro di voler eliminare
    <ng-container *ngIf="mediaInput.length === 1; else multiple">
      questo media dal carosello?
    </ng-container>
    <ng-template #multiple>
      questi {{ mediaInput.length }} media dal carosello?
    </ng-template>
  </p>
</div>

<!-- Azioni in basso -->
<div mat-dialog-actions align="end"
     class="delete-dialog-actions"
     [class.blur]="eliminazioneInCorso">

  <!-- Pulsante Annulla -->
  <button mat-stroked-button
          color="primary"
          type="button"
          (click)="annulla()">
    Annulla
  </button>

  <!-- Pulsante elimina tutti -->
  <button mat-flat-button
          color="warn"
          type="button"
          (click)="deleteMedia(true)">
    Elimina tutti i media
  </button>
</div>
