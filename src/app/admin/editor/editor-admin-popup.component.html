<div class="dialog-content">

  <!-- ðŸ”˜ Pulsante in alto a destra per chiudere il dialog -->
  <button class="chiudi-btn" mat-icon-button (click)="chiudiDialog()">
    <mat-icon>close</mat-icon>
  </button>

  <!-- ðŸ“¦ Contenitore flessibile di tutte le card di anteprima -->
  <div class="preview-container">

    <!-- ðŸ” Itero su tutte le immagini frontali (una per asset) -->
    <div 
      class="preview-card"
      *ngFor="let url of mediasUrlsFrontale"
      (mouseenter)="hoveredCard = url"
      (mouseleave)="hoveredCard = null"
    >
      <div class="card-inner">
        <!-- ðŸ“„ Estraggo i metadati context associati all'URL -->
        <ng-container *ngIf="contextMap[url] as context">

          <!-- ðŸ–¼ï¸ Immagine principale frontale -->
          <img 
            [src]="url" 
            [alt]="'Immagine frontale di ' + context.display_name"
          />

          <!-- ðŸ§¾ Blocco metadati (nome file, descrizione, quantitÃ , ecc.) -->
          <div class="media-display-name">
            <!-- Tooltip solo se descrizione Ã¨ lunga -->
            <span 
              class="tooltip-wrapper"
              [matTooltip]="context.descrizione"
              matTooltipClass="tooltip-admin"
              [matTooltipDisabled]="!isLongText(context.descrizione)"
              matTooltipPosition="above"
              matTooltipTrigger="hover"
              matTooltipShowDelay="0"
              matTooltipHideDelay="0"
            >
              <!-- Mostro metadati ordinati -->
              <ng-container *ngFor="let contextFormatted of getOrderedFormattedEntries(context)">
                <div class="context-entry">
                  <strong class="context-label">
                    {{ contextFormatted.label }}:
                  </strong>
                  <span class="context-value">
                    {{ getPreview(contextFormatted.value) }}
                  </span>
                </div>
              </ng-container>
            </span>
          </div>

          <!-- ðŸ–¼ï¸ Immagini non frontali mostrate solo al passaggio del mouse -->
          <ng-container *ngIf="mapUrlsNoFrontali[url] as urlsNoFrontali">
            <div
              class="non-frontali-overlay"
              *ngIf="urlsNoFrontali.length > 0 && hoveredCard === url"
            >
              <img
                *ngFor="let urlLaterale of urlsNoFrontali"
                [src]="urlLaterale"
                [alt]="'Altra angolazione di ' + context.display_name"
              />
            </div>
          </ng-container>

        </ng-container>
      </div>
    </div>

  </div>
</div>
