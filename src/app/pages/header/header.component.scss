/* =======================================================
   HEADER COMPONENT (app-header) — modalità IBRIDA
   - Mobile: sticky sul mat-toolbar (.app-header)
   - Desktop: sticky sul wrapper del componente (:host)
   - Obiettivo: non “mollare” mai, qualunque sia lo scroller
   ======================================================= */

:host {
  display: block;
  width: 100%;
  /* niente sticky qui in mobile; in desktop lo mettiamo nel breakpoint */
}

/* ---------------------------------------
   Stili COMUNI al mat-toolbar
   --------------------------------------- */
.app-header,
.app-header > .mat-toolbar-row,
.app-header > .mat-mdc-toolbar-row {
  background: #fff;
  color: #000;
  box-shadow: none;
  border: 0;

  display: grid;
  align-items: center;

  /* Evita “sticky killers” locali */
  transform: none;
  overflow: visible;
}

/* Pulsante hamburger (comune) */
.menu-button {
  grid-column: 1;
  justify-self: start;
  border: 0;
  background: transparent;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  margin: 0;
  cursor: pointer;

  .mat-icon, mat-icon {
    color: currentColor;
    line-height: 1;
    display: block;
  }

  &:focus-visible {
    outline: 2px solid #0ea5e9;
    outline-offset: 2px;
    border-radius: 6px;
  }
}

/* Logo (comune) */
.logo {
  grid-column: 2;
  justify-self: center;
  display: inline-block;
  width: auto;
  cursor: pointer;
  user-select: none;
  margin: 0;
}

/* Spazio destro per simmetria (comune) */
.right-space {
  grid-column: 3;
  justify-self: end;
  height: 1px;
}

/* =======================================================
   MOBILE (<= 768px)
   - BODY è lo scroller (vedi styles.scss)
   - Banner mobile è static (~32px) e scorre via
   - Sticky sul WRAPPER (:host); toolbar neutro
   ======================================================= */
@media (max-width: 768px) {
  /* wrapper sticky: si aggancia al body (safe-area già “pagata” dal padding-top) */
  :host{
    position: -webkit-sticky;
    position: sticky;
    top: 0;                       /* attaccato al bordo alto del scrollport */
    z-index: 1100;                /* sopra ai contenuti */
    background: #fff;
    transform: none;              /* difesa extra */
    will-change: position;
  }

  /* toolbar neutro dentro il wrapper sticky */
  .app-header{
    position: static;
    width: 100%;
    height: 64px; min-height: 64px;
    display: grid;
    grid-template-columns: 64px 1fr 64px;
    align-items: center;
  }

  .menu-button{ width:64px; height:64px;
    .mat-icon, mat-icon{ font-size:28px; }
  }
  .logo{ height:42px; }
  .right-space{ width:64px; }

  /* nessun pseudo che possa coprire lo sticky */
  :host::before, :host::after,
  .app-header::before, .app-header::after { content:none; }
}

/* —— Variante: header già “attaccato” sotto il banner da SUBITO ——
@media (max-width: 768px) {
  :host { top: 32px; }  // 32px = altezza banner mobile
}
*/





/* =======================================================
   DESKTOP (>= 769px)
   - Scroller: .mat-sidenav-content (o html se capita)
   - Sticky sul WRAPPER (funziona in entrambi i casi)
   - Toolbar resta “statica” dentro il wrapper sticky
   ======================================================= */
@media (min-width: 769px) {
  /* sticky sul WRAPPER: si aggancia sia a .mat-sidenav-content che a html */
  :host {
    position: sticky;
    top: 0;                                    /* attaccato al bordo alto */
    z-index: 1001;                             /* se il banner tornasse sticky: banner a 1002 */
    background: #fff;
    box-shadow: none;
  }

  /* il toolbar NON è sticky in desktop (evita conflitti) */
  .app-header {
    position: static;                          /* neutro: vive nel wrapper sticky */
    width: 100%;
    height: 88px;
    min-height: 88px;
    grid-template-columns: 88px 1fr 88px;
  }

  .menu-button { width: 88px; height: 88px;
    .mat-icon, mat-icon { font-size: 24px; }
  }

  .logo { height: 56px; }
  .right-space { width: 88px; }
}

/* =======================================================
   NOTE
   - Antenati del toolbar e del wrapper: overflow: visible e nessun transform
     (già centralizzato in styles.scss).
   - Mobile: niente offset “+32px” nel top perché il banner è static
     e scorre via prima che lo sticky si attivi → l’header tocca la safe bar.
   - Desktop: sticky sul wrapper garantisce affidabilità anche
     se, per qualsiasi motivo, lo scroller diventasse html.
   ======================================================= */
