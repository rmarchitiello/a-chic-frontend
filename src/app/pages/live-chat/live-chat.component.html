<!-- =============== DESKTOP =============== -->
<ng-container *ngIf="!isMobile">
    <div class="desktop-chat-button">ðŸ’¬</div>
</ng-container>

<!-- =============== MOBILE =============== -->
<ng-container *ngIf="isMobile">
    <!-- FAB di apertura -->
    <div class="mobile-chat-button" (click)="apriChat()">
        <img src="assets/images/icona-whatsapp.png" alt="chat" />
    </div>

    <!-- Overlay + pannello (visibili solo se chatAperta) -->
    <ng-container *ngIf="chatAperta">
        <!-- area scura cliccabile per chiudere -->
        <div class="chat-overlay" (click)="chiudiChat()"></div>

        <!-- pannello vero e proprio -->
        <div class="mobile-chat-panel" (click)="$event.stopPropagation()">

            <!-- header verde -->
            <div class="chat-header">
                Supporto Live
                <span class="chiudi" (click)="chiudiChat()">âœ–</span>
            </div>

            <!-- messaggi -->
            <div class="chat-body" #contenitoreChat>
                <!-- loop dei messaggi utente -->
                <div *ngFor="let msg of messaggi"
                    [ngClass]="msg.tipo === 'utente' ? 'messaggio-utente' : 'messaggio-system'">
                    {{ msg.testo }}
                </div>

            </div>

            <!-- form di invio -->
            <form class="chat-form" (ngSubmit)="inviaMessaggio()" #frm="ngForm">
                <mat-form-field appearance="fill" class="input-msg">
                    <input matInput name="testo" [(ngModel)]="messaggioCorrente" placeholder="Scrivi un messaggioâ€¦"
                        required />
                </mat-form-field>

                <!-- pulsante send SOLO se câ€™Ã¨ testo -->
                <button mat-icon-button color="primary" type="submit" *ngIf="messaggioCorrente.trim()">
                    <mat-icon>send</mat-icon>
                </button>
            </form>
        </div>
    </ng-container>
</ng-container>