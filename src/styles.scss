/* Carosello dinamico vedi la home */

//qui importo le frecce next prev ecc.. in modo da fare import { Arrow } from '@egjs/flicking-plugins';
/* Qualsiasi cosa aggiungo deve andare dentro all import plugin in questo modo 
plugins: Plugin[] = [
  new Arrow(),                        // frecce
  new Pagination({ type: "bullet" }), // pallini
  new AutoPlay({ duration: 3000 })    // autoplay
];
*/
//qua importo le frecce 
@import "@egjs/flicking-plugins/dist/arrow.css";
//import dei pallini
@import "@egjs/flicking-plugins/dist/pagination.css";


/* =========================================================
   GESTIONE DI CHI SCROLLA — styles.scss (fonte unica)
   - MOBILE  (<=768px): scorre il DOCUMENTO (html/body)
   - DESKTOP (>=769px): scorre .mat-sidenav-content / .mat-drawer-content
   - Niente “sticky killers” (overflow/transform) sui wrapper
   - Evito scroll-chaining e stabilizzo la scrollbar su desktop
   - ATTENZIONE: colori/skin del sidenav NON qui (li metto in AppComponent)
   ========================================================= */

/* ——— BASE (sempre) ——— */
html,
body {
  margin: 0;
  padding: 0;
  min-height: 100vh;
  -webkit-overflow-scrolling: touch;   /* inerzia iOS */
  background: #fff !important;         /* status bar iOS chiara */
}
html { -webkit-text-size-adjust: 100%; }
:root { color-scheme: light; }

/* Wrapper Material: NON deve clippar e NON deve trasformare
   (transform crea stacking context e rompe molti sticky) */
mat-sidenav-container {
  overflow: visible !important;
  transform: none !important;
  will-change: auto !important;
}

/* Content wrappers: niente transform/sticky-killers */
.mat-sidenav-content,
.mat-drawer-content,
.cdkScrollable {
  transform: none !important;
  will-change: auto !important;
}

/* Desktop “qualità vita”: niente jump quando appare la scrollbar
   Se vuoi anche “spazio” lato sinistro/destro attorno alla barra,
   cambia in `stable both-edges`. */
@media (hover: hover) and (pointer: fine) {
  .sidenav-container .mat-sidenav-content { scrollbar-gutter: stable; }
}

/* =========================================================
   MOBILE (<= 768px) — scorre il DOCUMENTO (html/body)
   - Voglio l’header subito sotto il notch
   - Tolgo sticky-killers dai wrapper
   - Il PANNELLO del sidenav è opaco (ma il COLORE si setta in AppComponent)
   ========================================================= */
@media (max-width: 768px) {

  /* 1) Il documento è lo scroller */
  html, body {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch;
    padding-top: env(safe-area-inset-top, 0); /* header “attaccato” al notch */
    background: #fff;
  }

}

/* =========================================================
   DESKTOP (>= 769px) — scorre il CONTENT
   - Qui blocco html/body e faccio scorrere .mat-sidenav-content/.mat-drawer-content
   - Niente skin: il colore della sidenav sta in AppComponent
     (variabile: `--sidenav-bg-desktop`)
   ========================================================= */
@media (min-width: 769px) {
  /* 1) Il documento NON scorre (evito doppi scroll) */
  html, body {
    overflow: hidden !important;
    height: 100% !important;
  }

  /* 2) Mantengo il container a tutta viewport (utile per sticky & height) */
  .mat-sidenav-container,
  .sidenav-container {
    height: 100dvh;
  }

  /* 3) Unico scroller = content; niente padding/margini forzati qui */
  .mat-sidenav-container .mat-sidenav-content,
  .mat-sidenav-content,
  .mat-drawer-content {
    height: 100vh !important;
    height: 100dvh !important;      /* preferibile su browser moderni */
    overflow-y: auto !important;
    overflow-x: hidden !important;
    position: relative !important;
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
    scrollbar-gutter: stable;       /* se vuoi “aria” anche a sinistra: stable both-edges */
    padding: 0 !important;
  }

  
}

/* =========================================================
   EDGE CASES ANGULAR MATERIAL
   ========================================================= */

/* MatDialog: il CDK blocca lo scroll del body quando è aperto (giusto così) */
.cdk-global-scrollblock { overflow: hidden !important; }

/* (Opzionale) Verniciatura notch iOS
body::before {
  content: "";
  position: fixed;
  inset: 0 0 auto 0;
  height: env(safe-area-inset-top, 0px);
  background: #fff;
  pointer-events: none;
  z-index: 1100;
}
*/



/* GESTIONE DEI POP UP E COME FUNZIONANO
Quando si applica un pop up

this.dialog.open(ComponentePopup, {
  data: { ... },
  panelClass: 'mia-classe-personalizzata'
});

viene generato nel dom

<div class="cdk-overlay-container">
  <div class="cdk-overlay-backdrop"></div>  <!-- Sfondo scuro (backdrop) -->
  
  <div class="cdk-global-overlay-wrapper">
    <div class="cdk-overlay-pane mia-classe-personalizzata">  <!-- Classe personalizzata -->
      <mat-dialog-container class="mat-mdc-dialog-container">
        <div class="mat-mdc-dialog-inner-container">
          <div class="mat-mdc-dialog-surface">
            <!-- Contenuto del TUO componente -->
            <app-mio-popup>
              <mat-dialog-content>
                <!-- Template del TUO componente -->
              </mat-dialog-content>
            </app-mio-popup>
          </div>
        </div>
      </mat-dialog-container>
    </div>
  </div>
</div>

.cdk-overlay-container
È il contenitore "globale" creato automaticamente da Angular CDK.

Viene aggiunto direttamente al body.

Non modificarlo manualmente se non in casi eccezionali.

.cdk-overlay-backdrop
È lo sfondo che rende scuro il resto della pagina quando un popup si apre.

Può essere personalizzato con classi specifiche, se necessario.

.cdk-overlay-pane
È il pannello vero e proprio che ospita il popup.

Qui puoi aggiungere una tua classe personalizzata tramite l’opzione panelClass nel metodo .open() del popup.

Subito dopo..

mat-dialog-container
È il contenitore diretto del tuo popup.

Ha classi predefinite Angular Material come .mat-mdc-dialog-container.

Puoi personalizzare sfondi, padding, ecc. tramite il tuo CSS.


app-mio-popup
Questo è il tuo componente Angular (es: ViewOrEditDescrizioneComponent).

Qui puoi definire il tuo template personalizzato e logica TypeScript.

e nel mio pop up uso
mat-dialog-content (opzionale ma consigliato)
È un wrapper di contenuto che offre Angular Material.

Consigliato perché ha stili predefiniti (padding automatico).

*/

/*
Ora nell editor quandro apro il pop up

  // Apertura del dialog Angular Material per il componente ViewMetadata
this.dialog.open(ViewMetadata, {
  data: { urlFrontale: url, context: context },
  panelClass: 'popup-view-dialog' // Questo collega lo stile alla .cdk-overlay-pane
});
}

nel dom avro <div id="cdk-overlay-1" class="cdk-overlay-pane popup-view-dialog mat-mdc-dialog-panel" style="position: static;">

e posso modificare qui il pop up come deve essere class="cdk-overlay-pane popup-view-dialog mat-mdc-dialog-panel
e o lo faccio globalmente, o lo faccio nella classe che apre il pop up ovvero nel padre
usando ng deep, invece qua lo sto facendo globale tanto sono sicuro che la modifica impatta solo li

Quando apro un pop up di material quel bordo grigio
e delle classi base di material
.mat-mdc-dialog-container
.mdc-dialog__surface

che nel dom 

<div id="cdk-overlay-1" class="cdk-overlay-pane popup-view-dialog mat-mdc-dialog-panel" style="position: static;">
	<div tabindex="0" class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"/>
	<mat-dialog-container tabindex="-1" class="mat-mdc-dialog-container mdc-dialog cdk-dialog-container mdc-dialog--open" id="mat-mdc-dialog-1" role="dialog" aria-modal="false" style="--mat-dialog-transition-duration: 150ms;">
		<div class="mat-mdc-dialog-inner-container mdc-dialog__container">
			<div class="mat-mdc-dialog-surface mdc-dialog__surface">

      sono figli di popup-view-dialog e faccio cosi

      .cdk-overlay-pane.popup-view-dialog .mat-mdc-dialog-surface {
  background-color: #25d366 !important; // Verde acceso
  box-shadow: none !important;
  border-radius: 0 !important;
  padding: 0 !important;
}

perche uso .cdk-overlay-pane.popup-view-dialog.mat-mdc-dialog-panel {
 tutto attaccato (perche sono della stessa classe)

 .cdk-overlay-pane.popup-view-dialog .mat-mdc-dialog-surface {
qua no perche surface è il figlio

Ora se ho due pop up come faccio a dire quello va sopra l'altro ? devo incidere sull asse z 

supponiamo faccio 
this.dialog.open(PopupBComponent, {
  panelClass: 'popup-b-zindex',
});


this.dialog.open(PopupAComponent, {
  panelClass: 'popup-a-zindex',
});

.cdk-overlay-pane.popup-b-zindex {
  z-index: 1000 !important;
}

.cdk-overlay-pane.popup-a-zindex {
  z-index: 1100 !important; // Questo sarà sopra
}

A SARA SOPRA A B
non uso .cdk-overlay-pane.popup-a-zindex.mat-mdc-dialog-panel { ... }
 ma direttamente il contenitore padre

 Se a un pop up voglio assegnare un altezza larghezza ecc ho due strade, o faccio 
 this.dialog.open(ViewOrEditMetadataComponent, {
  panelClass: 'popup-view-dialog',
  width: '600px',          // oppure '80vw'
  height: '400px',         // oppure 'auto', '90vh', ecc.
  data: { ... }
});

o cosi
.cdk-overlay-pane.popup-view-dialog.mat-mdc-dialog-panel {
  width: 600px !important;      // oppure '80vw'
  height: 400px !important;     // oppure 'auto' o '90vh'
  max-height: 90vh !important;  // utile per scroll
  max-width: 95vw !important;


  In generale si fa cosi:

  ::ng-deep .cdk-overlay-pane.popup-admin-editor  lo uso per indicare una dimensione del pop up bordi ecc
    Lo stai usando per stilizzare il contenitore principale del dialog Material (quello che gestisce larghezza, altezza, bordo, ombre, posizione, z-index del popup). Questo è esattamente il posto giusto dove agire per definire:
  width, height, max-width, max-height
  padding, margin
  border-radius
  box-shadow
  z-index
  pointer-events
  top, left

  ::ng-deep .popup-admin-editor .mat-mdc-dialog-content contenuto del pop pup scrollabile ecc..


  ::ng-deep .popup-admin-editor .mat-mdc-dialog-surface per indicare la superfice se trasparente o altro 
*/

  /* Overlay principale del popup con panelClass: 'popup-view-dialog' */
  .cdk-overlay-pane.popup-view-dialog.mat-mdc-dialog-panel { //opzionale specificare anche mat-mdc-dialog-panel 
    width: auto !important;
    height: auto !important;
    max-width: none !important;   // Rimuove limiti massimi
    max-height: none !important;  // Rimuove limiti massimi
    overflow: visible !important; // Permette espansione    

    border-radius: 0 !important;     // Rimuove angoli stondati
    box-shadow: none !important;     // Rimuove ombra esterna
    padding: 0 !important;           // Rimuove padding interno
    overflow: visible !important;    // Permette elementi fuori dal riquadro (es. effetti o frecce)
    pointer-events: auto !important; // Garantisce l'interazione (hover/click)
  }

  /* Superficie interna del dialog Material */
  .cdk-overlay-pane.popup-view-dialog .mat-mdc-dialog-surface {
    background-color: transparent !important; // Sfondo trasparente
    box-shadow: none !important;              // Nessuna ombra
    border-radius: 0 !important;              // Nessun bordo stondato interno
    padding: 0 !important;                    // Rimuove padding interno
  }


/* ora da qui in po mettero tutti i pop up nelle classi padre senza intaccare lo style scss quindi xon ng deep */


/* Applica a TUTTI i dialog (popup) Angular Material */
.cdk-overlay-backdrop {
  background-color: rgba(0, 0, 0, 0.7) !important;  // più scuro
  backdrop-filter: blur(5px);                      // effetto sfocato
}






/* Tooltip Angular Material (MDC) – versione grande, semi-trasparente */
/* MDC (Angular Material 15+) */
.tooltip-custom.mdc-tooltip .mdc-tooltip__surface {
  background-color: rgba(17, 17, 17, 0.65); /* prima 0.85 */
  color: #fff;
  border-radius: 12px;
  padding: 12px 14px;
  font-size: 15px;
  line-height: 1.4;
  max-width: 420px;
  white-space: normal;
  box-shadow: 0 10px 28px rgba(0, 0, 0, 0.25);
  backdrop-filter: blur(3px) saturate(120%); /* leggero boost di leggibilità */
  /* opzionale: un filo di text-shadow per contrasto su sfondi complessi */
  text-shadow: 0 1px 1px rgba(0,0,0,0.25);
}

.tooltip-custom.mdc-tooltip .mdc-tooltip__caret-surface {
  background-color: rgba(17, 17, 17, 0.65);
}

/* Legacy (pre-MDC), se serve */
.mat-tooltip.tooltip-custom {
  background-color: rgba(17, 17, 17, 0.65);
  color: #fff;
  border-radius: 12px;
  padding: 12px 14px;
  font-size: 15px;
  line-height: 1.4;
  max-width: 420px;
  white-space: normal;
  box-shadow: 0 10px 28px rgba(0,0,0,0.25);
  backdrop-filter: blur(3px) saturate(120%);
  text-shadow: 0 1px 1px rgba(0,0,0,0.25);
}




//SNACK BARRRRR

/*──────────────────────────────────────────────────────────────
  ANIMAZIONI
──────────────────────────────────────────────────────────────*/
@keyframes snackIn {
  0%   { transform: translateY(-30%) scale(.95) rotateX(15deg); opacity: 0; }
  60%  { transform: translateY(5%)  scale(1.02);                 }
  100% { transform: translateY(0)   scale(1)    rotateX(0);  opacity: 1; }
}

@keyframes pulseGlow {
  0%,100% { box-shadow: 0 0 8px rgba(255,255,255,.25); }
  50%     { box-shadow: 0 0 14px rgba(255,255,255,.55); }
}

@keyframes barDrain { from { width: 100%; } to { width: 0%; } }

/*──────────────────────────────────────────────────────────────
  STILE BASE (mixin-like via placeholder)
──────────────────────────────────────────────────────────────*/
%snackbar-base {
  position: relative;
  padding: 18px 30px 22px;          /* spazio extra per progress-bar */
  width: fit-content;
  max-width: 480px;
  margin: 0 auto;
  color: #fff !important;
  font: 600 15px/1.4 "Inter", sans-serif;
  display: flex;
  align-items: center;
  gap: 20px;
  border-radius: 14px;
  overflow: hidden;                 /* clip-bar & glow */
  backdrop-filter: blur(8px);
  animation: snackIn .4s ease-out;

  /* effetto glow pulsante sul container intero */
  &:hover { animation: pulseGlow 1.2s infinite linear; }

  /* rimuove superficie di default Material */
  .mdc-snackbar__surface,
  .mat-mdc-snackbar-surface {
    background: transparent !important;
    box-shadow: none !important;
  }

  /* testo */
  .mat-mdc-snack-bar-label { flex: 1; }

  /* pulsante */
  .mat-mdc-snack-bar-action {
    color: inherit !important;
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: .5px;
    cursor: pointer;
    transition: transform .15s ease, opacity .15s ease;
    &:hover   { transform: scale(1.08); opacity: .9; }
    &:active  { transform: scale(.92);  opacity: .8; }
  }

}

/*──────────────────────────────────────────────────────────────
  ERRORE
──────────────────────────────────────────────────────────────*/
.snackbar-errore {
  @extend %snackbar-base;

  /* sfondo con glass-gradient rosso */
  background: rgba(255, 77, 79, .85);
  background: linear-gradient(135deg,
              rgba(255,77,79,.92) 0%,
              rgba(205,25,30,.88) 60%,
              rgba(155,15,18,.9)  100%);

  /* accent bar */
  &::before {
    content:"";
    position:absolute;
    left:0; top:0; bottom:0;
    width:6px;
    background: linear-gradient(to bottom,#ff9d9f,#ff4d4f 60%,#c4171a 100%);
  }
  &::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: 0;
    height: 4px;
    background: currentColor;
    animation: barDrain 1s linear forwards;
  }
}

/*──────────────────────────────────────────────────────────────
  SUCCESSO
──────────────────────────────────────────────────────────────*/
.snackbar-ok {
  @extend %snackbar-base;

  background: rgba(76, 175, 80, .85);
  background: linear-gradient(135deg,
              rgba(99, 214,103,.94) 0%,
              rgba(76,175,80,.92)   60%,
              rgba(56,142,60,.88)   100%);

  &::before {
    content:"";
    position:absolute;
    left:0; top:0; bottom:0;
    width:6px;
    background: linear-gradient(to bottom,#b7f7ba,#4caf50 60%,#388e3c 100%);
  }

  &::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: 0;
    height: 4px;
    background: currentColor;
    animation: barDrain 0.5s linear forwards;
  }
}




/* Rimuovi state layer e ripple dai mat-icon-button */
button.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,
button.mat-mdc-icon-button .mdc-icon-button__ripple::before,
button.mat-mdc-icon-button .mdc-icon-button__ripple::after {
  display: none !important;
  background: transparent !important;
  opacity: 0 !important;
}

/* Disattiva le opacità ripple via variabili MDC */
button.mat-mdc-icon-button {
  --mdc-ripple-hover-opacity: 0 !important;
  --mdc-ripple-focus-opacity: 0 !important;
  --mdc-ripple-pressed-opacity: 0 !important;
}



//stili globali per il carosello flicking
 /* Li ho sovrascritti dall import di sopra*/
  /* --- Contenitore frecce: ben visibili e centrate verticalmente 
  Potevo anche importare direttamente l'scss e andare poi a sovrascrivere nel senso copiavo e incollare arrow e pagination e li mettevo qua pero io qua sto 
  sovrascrivendo non tutto per esempio le frecce nell arrow.css sono cursor pointer invece qua non sto dicendo cursor pointer (ma lo sono questo perche)
  stiamo prendendo sia le classi dell import che le mie sovrascritte a patto che nel template utilizziamo gli stessi nomi
    <span in-viewport class="flicking-arrow-prev"></span>
  <span in-viewport class="flicking-arrow-next"></span>

  <!-- pallini -->
  <div in-viewport class="flicking-pagination"></div>
  */
  /* ============================================================================
   Ngx-Flicking: frecce + pagination (stile minimale)
   Inserito nello SCSS globale → non serve :host o ::ng-deep
   ========================================================================== */

/* --- FRECCE ------------------------------------------------------------- */

/* ============================================================================
   Ngx-Flicking — stile globale: frecce + pagination
   Base comune + media queries per mobile e desktop
   ========================================================================== */

/* ——— BASE COMUNE ———————————————————————————————————————————————— */

/* reset grafica di default del plugin (barrette arancioni) */
.flicking-arrow-prev::before,
.flicking-arrow-prev::after,
.flicking-arrow-next::before,
.flicking-arrow-next::after {
  content: "" !important;
  background: transparent !important;
  width: 0 !important;
  height: 0 !important;
  top: auto !important;
  left: auto !important;
  right: auto !important;
  transform: none !important;
  box-shadow: none !important;
  position: static !important;
}

/* contenitore frecce */
.flicking-arrow-prev,
.flicking-arrow-next {
  position: absolute !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  -webkit-tap-highlight-color: transparent !important;
  outline: none !important;
  pointer-events: auto !important;
  z-index: 5 !important;
  opacity: 0.7 !important; /* discrete */
}

/* pagination wrapper */
.flicking-pagination {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px !important;
}

/* pallini base (verranno ridimensionati nelle media query) */
.flicking-pagination-bullet {
  border-radius: 50% !important;
  background: rgba(255,255,255,0.35) !important; /* chiaro trasparente */
  border: 1px solid rgba(0,0,0,0.7) !important;  /* contorno nero */
  box-shadow: none !important;
  opacity: .6 !important;
  transition: opacity 150ms ease, transform 150ms ease !important;
}
.flicking-pagination-bullet-active {
  background: #000 !important;
  border-color: #000 !important;
  opacity: 1 !important;
  transform: none !important;
}

/* ——— MOBILE (≤ 767px) ———————————————————————————————————————— */
@media (max-width: 767px) {

  /* area cliccabile più compatta, frecce vicine al bordo */
  .flicking-arrow-prev,
  .flicking-arrow-next {
    width: 28px !important;
    height: 28px !important;
  }
  .flicking-arrow-prev { left: 8px !important; }
  .flicking-arrow-next { right: 8px !important; }

  /* chevron neri sottili */
  .flicking-arrow-prev::before,
  .flicking-arrow-next::before {
    content: "" !important;
    display: block !important;
    width: 12px !important;
    height: 12px !important;
    border-top: 2px solid #000 !important;
    border-right: 2px solid #000 !important;
    background: transparent !important;
    margin: 0 auto !important;
  }
  .flicking-arrow-prev::before  { transform: rotate(-135deg) !important; } /* ← */
  .flicking-arrow-next::before  { transform: rotate(45deg)  !important; }  /* → */

  /* pagination più piccola e soft */
  .flicking-pagination-bullet {
    width: 7px !important;
    height: 7px !important;
    opacity: .55 !important;
  }
}

/* ——— DESKTOP (≥ 768px) ——————————————————————————————————————— */
@media (min-width: 768px) {

  /* area cliccabile più ampia e più dentro il carosello */
  .flicking-arrow-prev,
  .flicking-arrow-next {
    width: 36px !important;
    height: 36px !important;
    opacity: .75 !important;
  }
  .flicking-arrow-prev { left: 14px !important; }
  .flicking-arrow-next { right: 14px !important; }

  /* chevron un filo più grande */
  .flicking-arrow-prev::before,
  .flicking-arrow-next::before {
    content: "" !important;
    display: block !important;
    width: 14px !important;
    height: 14px !important;
    border-top: 2px solid #000 !important;
    border-right: 2px solid #000 !important;
    background: transparent !important;
    margin: 0 auto !important;
  }
  .flicking-arrow-prev::before  { transform: rotate(-135deg) !important; }
  .flicking-arrow-next::before  { transform: rotate(45deg)  !important;  }

  /* pagination più leggibile ma non invadente */
  .flicking-pagination-bullet {
    width: 9px !important;
    height: 9px !important;
    opacity: .6 !important;
  }

  /* hover solo su device con hover */
  @media (hover: hover) {
    .flicking-arrow-prev:hover,
    .flicking-arrow-next:hover { opacity: .9 !important; }

    .flicking-pagination-bullet:hover {
      opacity: .8 !important;
      transform: scale(1.05) !important;
    }
  }
}



/* QUEST IMPORT LO INSERISCO QUALORA VOGLIO CAMBIARE IL PADDING DEL CAROSELLO DELLE FRECCE NEI COMPONENT FIGLI
:host ::ng-deep .flicking-arrow-prev { left: 6px !important; }
:host ::ng-deep .flicking-arrow-next { right: 6px !important; }
*/
